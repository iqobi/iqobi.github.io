<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Futoshiki Today</title>
    <link rel="stylesheet" href="style.css" />
    <script defer src="script.js"></script>
    <meta name="apple-itunes-app" content="app-id=6740991239" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&display=swap"
      rel="stylesheet"
    />
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-HZN9E5YKPB"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-HZN9E5YKPB");
    </script>
  </head>
  <body>
    <div id="app">
      <!-- Header / Title -->
      <nav class="top-bar">
        <div class="title-container">
          <div class="title-back">‰ªäÊó•</div>
          <div class="title-front" id="title-today">Today</div>
        </div>
        <button class="rules-button" id="show-rules-btn">How to play?</button>
      </nav>

      <!-- Main content -->
      <div class="main-content">
        <!-- Timer display -->
        <div class="timer" id="timer-label">00:00</div>

        <!-- Puzzle container -->
        <div class="puzzle-container" id="puzzle-container">
          <!-- The puzzle grid and constraints will be injected here by JS -->
        </div>

        <!-- Number toolbar -->
        <div class="toolbar" id="number-toolbar">
          <!-- Will be populated with number buttons or share button -->
        </div>
      </div>
    </div>

    <!-- Reveal overlay -->
    <div id="reveal-overlay" class="reveal-overlay">
      <button id="reveal-btn" class="reveal-button">Reveal Futoshiki</button>

      <a href="https://apps.apple.com/us/app/futoshiki-today/id6740991239">
        <img
          src="button.svg"
          alt="Download on the App Store"
          class="app-store-button"
        />
      </a>
    </div>

    <!-- Rules modal -->
    <div class="modal hidden" id="rules-modal">
      <div class="modal-content rules-modal-content">
        <header class="rules-header">
          <h2>How to Play</h2>
          <button id="close-rules-btn" class="icon-button" aria-label="Close">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                fill="currentColor"
                d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
              />
            </svg>
          </button>
        </header>

        <div class="rules-content">
          <section class="rules-intro">
            <h3>Welcome to Futoshiki!</h3>
            <p>
              A unique puzzle that combines numbers and inequality signs into an
              engaging logical challenge.
            </p>
          </section>

          <section class="rules-main">
            <div class="rule-card">
              <div class="rule-icon">
                <svg width="32" height="32" viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 2v14H5V5h14Z"
                  />
                </svg>
              </div>
              <div class="rule-content">
                <h4>Fill the Grid</h4>
                <p>
                  Place numbers 1-4 in each row and column. Each number can only
                  appear once in each row and column.
                </p>
                <div class="rule-example">
                  <div class="mini-grid">
                    <div>1</div>
                    <div>4</div>
                    <div>2</div>
                    <div>3</div>
                    <div>3</div>
                    <div>2</div>
                    <div>4</div>
                    <div>1</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="rule-card">
              <div class="rule-icon">
                <svg width="32" height="32" viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M16 17.01V10h-2v7.01h-3L15 21l4-3.99h-3zM9 3L5 6.99h3V14h2V6.99h3L9 3z"
                  />
                </svg>
              </div>
              <div class="rule-content">
                <h4>Follow the Signs</h4>
                <p>
                  The inequality signs (< and >) between cells must be satisfied
                  by your numbers.
                </p>
                <div class="rule-example inequalities">
                  <div class="inequality-example">
                    <span>2</span>
                    <span class="sign">&gt;</span>
                    <span>1</span>
                    <div class="caption">Valid: 2 > 1</div>
                  </div>
                  <div class="inequality-example">
                    <span>1</span>
                    <span class="sign">&lt;</span>
                    <span>3</span>
                    <div class="caption">Valid: 1 < 3</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="rule-card">
              <div class="rule-icon">
                <svg width="32" height="32" viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5l1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"
                  />
                </svg>
              </div>
              <div class="rule-content">
                <h4>Track Your Progress</h4>
                <p>Your solving journey is recorded with these symbols:</p>
                <div class="progress-grid">
                  <div class="progress-item">
                    <span class="emoji">‚úÖ</span>
                    <span>Correct move</span>
                  </div>
                  <div class="progress-item">
                    <span class="emoji">‚ùå</span>
                    <span>Incorrect move</span>
                  </div>
                  <div class="progress-item">
                    <span class="emoji">üîÑ</span>
                    <span>Changed number</span>
                  </div>
                  <div class="progress-item">
                    <span class="emoji">üîô</span>
                    <span>Cleared number</span>
                  </div>
                  <div class="progress-item">
                    <span class="emoji">‚ú¥Ô∏è</span>
                    <span>Reset puzzle</span>
                  </div>
                  <div class="progress-item">
                    <span class="emoji">‚ú®</span>
                    <span>Perfect solve!</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="rule-card">
              <div class="rule-icon">
                <svg width="32" height="32" viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1s-1-.45-1-1s.45-1 1-1zm0 4c1.66 0 3 1.34 3 3s-1.34 3-3 3s-3-1.34-3-3s1.34-3 3-3zm6 12H6v-1.4c0-2 4-3.1 6-3.1s6 1.1 6 3.1V19z"
                  />
                </svg>
              </div>
              <div class="rule-content">
                <h4>Example Paths</h4>
                <div class="path-examples">
                  <div class="path-row">
                    <div class="path-label">Perfect:</div>
                    <div class="path-moves">‚úÖ‚úÖ‚úÖ‚úÖ‚ú®</div>
                  </div>
                  <div class="path-row">
                    <div class="path-label">Learning:</div>
                    <div class="path-moves">‚ùåüîÑ‚úÖ‚úÖ‚úÖ</div>
                  </div>
                  <div class="path-row">
                    <div class="path-label">Fresh Start:</div>
                    <div class="path-moves">‚ùå‚ùå‚ú¥Ô∏è‚úÖ‚úÖ‚úÖ‚úÖ</div>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <section class="rules-footer">
            <button
              class="primary-button"
              onclick="document.getElementById('rules-modal').classList.add('hidden')"
            >
              Let's Play!
            </button>
          </section>
        </div>
      </div>
    </div>

    <!-- Share sheet (for mobile) -->
    <div class="modal hidden" id="share-modal">
      <div class="modal-content">
        <div class="share-text" id="share-text">
          <!-- Will be populated by JavaScript with the formatted share text -->
        </div>
        <div class="share-buttons">
          <button id="copy-share-btn" class="close-button">Copy</button>
          <button id="close-share-btn" class="secondary-button">Close</button>
        </div>
        <a
          href="https://apps.apple.com/us/app/futoshiki-today/id6740991239"
          style="display: flex; justify-content: center; margin-top: 32px"
        >
          <img
            src="button.svg"
            alt="Download on the App Store"
            class="app-store-button"
          />
        </a>
      </div>
    </div>

    <!-- Add this before the closing body tag -->
    <div class="modal hidden" id="dev-modal">
      <div class="modal-content">
        <h2>Developer Options</h2>
        <div class="dev-options">
          <div class="date-picker-container">
            <label for="puzzle-date">Select Puzzle Date:</label>
            <input type="date" id="puzzle-date" class="date-input" />
            <button id="load-date-btn" class="close-button">Load Puzzle</button>
          </div>
          <div class="reset-container">
            <p>Reset current puzzle:</p>
            <button id="dev-reset-btn" class="secondary-button">
              Reset Today's Puzzle
            </button>
          </div>
        </div>
        <button id="close-dev-modal-btn" class="secondary-button">Close</button>
      </div>
    </div>
  </body>
</html>
